(this.webpackJsonpsurveyeditor=this.webpackJsonpsurveyeditor||[]).push([[0],{107:function(e,t,n){},120:function(e){e.exports=JSON.parse('{"a":[{"name":"Civil Supplies Distribution","category":"AP","id":"CSD","yaml":"AP/CSD.yml","icon":"https://epds1.ap.gov.in/epdsAP/images/AP.png"},{"name":"Citizen Survey","category":"AP","id":"CS","yaml":"AP/CS.yml","icon":"http://www.civilsupplies.telangana.gov.in/images/2017062280.pnghttps://epds1.ap.gov.in/epdsAP/images/AP.png"}]}')},134:function(e,t){},252:function(e,t,n){e.exports=n(682)},257:function(e,t,n){},681:function(e,t,n){var a={"./pwa-camera-modal-instance.entry.js":[695,5],"./pwa-camera-modal.entry.js":[696,6],"./pwa-camera.entry.js":[697,7],"./pwa-toast.entry.js":[698,8]};function r(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],r=t[0];return n.e(t[1]).then((function(){return n(r)}))}r.keys=function(){return Object.keys(a)},r.id=681,e.exports=r},682:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(18),s=n.n(o),i=(n(257),n(12)),l=n(27),u=n(21),c=n(36),d=n(37),p=n(13),m=n(39),h=n(11),f=(n(107),n(112)),y=n.n(f),g=(n(164),n(165),n(42)),v=n(20),b=n(8),E=n.n(b),w=n(749),j=n(765),O=n(776),k=n(764),x=n(780),C=n(745),S=n(206),q=n.n(S),_=n(207),L=n.n(_),D=n(208),I=n.n(D),N=n(143),A=n.n(N),U=n(209),R=n.n(U);function P(e){var t=e.editor?"navbar":"navbar1";return 0===e.current?r.a.createElement("div",{className:t},r.a.createElement(C.a,{variant:"outlined",color:"primary",endIcon:r.a.createElement(q.a,null),onClick:function(){return e.goto(e.current+1)}},"Start")):e.current===e.total-2?r.a.createElement("div",{className:t},r.a.createElement(C.a,{variant:"outlined",color:"primary",startIcon:r.a.createElement(A.a,null),onClick:function(){return e.goto(e.current-1)}},"Previous"),r.a.createElement(C.a,{variant:"outlined",color:"primary",startIcon:r.a.createElement(L.a,null),onClick:function(){e.submit()&&e.goto(e.current+1)}},"Submit")):e.current===e.total-1?r.a.createElement("div",{className:t},r.a.createElement(C.a,{variant:"outlined",color:"primary",startIcon:r.a.createElement(I.a,null),onClick:function(){return e.goto(0)}},"Repeat survey")):r.a.createElement("div",{className:t},r.a.createElement(C.a,{variant:"outlined",color:"primary",startIcon:r.a.createElement(A.a,null),onClick:function(){return e.goto(e.current-1)}},"Previous"),r.a.createElement(C.a,{variant:"outlined",color:"primary",endIcon:r.a.createElement(R.a,null),onClick:function(){return e.goto(e.current+1)}},"Next"))}var M=n(95),z=n(775);function B(e){var t=e.children,n=e.value,a=e.index;return r.a.createElement(M.a,{component:"div",role:"tabpanel",hidden:n!==a},n===a&&r.a.createElement(z.a,{p:3},t))}var T=n(62),W=n.n(T),Y=n(102),G=n(777),K=n(755),F=n(757),H=n(779),J=n(756),$=n(687),Q=n(781),V=n(750),X=n(216),Z=n.n(X),ee=n(217),te=n.n(ee),ne=n(94),ae=n(211),re=n.n(ae),oe=n(214),se=n(213),ie=n.n(se),le=r.a.createContext({username:"",lang:""}),ue=le.Provider,ce=(le.Consumer,le),de=n(761),pe=n(763),me=n(758),he=n(760),fe=n(762),ye=n(759),ge=n(79),ve=ne.d.Camera,be=ne.d.Geolocation,Ee=Object(w.a)((function(e){return{root:{"& .MuiTextField-root":{margin:e.spacing(1),width:"100%",textAlign:"center",flexGrow:1,border:"1px solid"}}}})),we={};function je(e){Object(a.useRef)(oe.a.getInstance("/wasmassets")).current;var t=Object(a.useContext)(ce).lang,n=r.a.useState({rowcount:1,colcount:1,textAlign:"center",addRows:!1,valid:!0}),o=Object(v.a)(n,2),s=o[0],l=o[1],u=r.a.useState(!0),c=Object(v.a)(u,2),d=c[0],p=c[1],m=r.a.useState(!0),f=Object(v.a)(m,2),y=f[0],g=f[1];function b(e){return E.apply(this,arguments)}function E(){return(E=Object(Y.a)(W.a.mark((function t(n){var a;return W.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,be.getCurrentPosition();case 2:a=t.sent,console.log("Current",a),e.store(n,[a.coords.latitude,a.coords.longitude]);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function w(){return(w=Object(Y.a)(W.a.mark((function t(n){var a;return W.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ve.getPhoto({resultType:ne.b.DataUrl,direction:ne.a.Rear,source:ne.c.Camera});case 2:a=t.sent,e.store(n,a);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function j(t){"checkbox"===t.target.type?e.store(t.target.name,t.target.checked):e.store(t.target.name,t.target.value),"select"===t.target.type&&"Other"===t.target.value?e.store(t.target.name+"_other",""):"multiselect"===t.target.type&&"Other"===t.target.checked&&e.store(t.target.name+"_other",""),"text"===t.target.type&&void 0!==e.question.format&&null!==e.question.format&&""!==e.question.format&&p(new RegExp(ge[e.question.format]).test(t.target.value)),void 0===e.question.mandatory||!e.question.mandatory||"textbox"!==e.question.type&&"textarea"!==e.question.type||""!==t.target.value?g(!1):g(!0)}function O(t){e.store(t.target.name+"_other",t.target.value)}function k(t,n){"undefined"==typeof we[n]&&(we[n]=[]),t.target.checked?we[n].push(t.target.name):we[n]=we[n].filter((function(e){return e!==t.target.name})),e.store(n,we[n])}r.a.useEffect((function(){e.question.mandatory&&void 0!==e.question.mandatory&&e.question.mandatory||g(!1)}),[]);var S=r.a.useState(!1),q=Object(v.a)(S,1)[0];function _(t){t&&(e.answers[e.uid]=t)}function L(e){console.error(e)}function D(e){try{for(var t=e.match(/[^\s']+|'([^']*)'/g),n=!1,a=!1,r=0;t.length>=r+3;r+=4)n=I(t.slice(r,r+3)),a=0===r?n:"and"===t[r+4]?a&&n:a||n;return a}catch(o){console.log(o)}}function I(t){var n=!1;return"is"===t[1]&&""+e.answers[e.questionLookup[t[0]]]===t[2].replace(/'/g,"")&&(n=!0),"isnot"===t[1]&&""+e.answers[e.questionLookup[t[0]]]!==t[2].replace(/'/g,"")&&(n=!0),"has"===t[1]&&-1!==e.answers[e.questionLookup[t[0]]].indexOf(t[2].replace(/'/g,""))&&(n=!0),"hasnot"===t[1]&&-1===e.answers[e.questionLookup[t[0]]].indexOf(t[2].replace(/'/g,""))&&(n=!0),n}function N(t,n){var a=t.substring(t.indexOf("_row")+4,t.indexOf("_col")),r=t.substring(t.indexOf("_col")+4),o=e.answers[e.uid];void 0!==o&&null!==o&&""!==o||(o=[]),void 0!==o[a]&&null!==o[a]&&""!==o[a]||(o[a]=[]),o[a][r]=n,e.store(e.uid,o)}var A=Ee(),U=e.question.mandatory?r.a.createElement("div",{style:{color:"red"}},"*"):null,R="checkbox"===e.question.type?r.a.createElement(V.a,{name:e.uid,onChange:j,color:"primary",checked:""!==e.answers[e.uid]&&e.answers[e.uid]}):null;if(void 0!==e.question.condition&&null!==e.question.condition&&""!==e.question.condition&&!D(e.question.condition))return null;var P,M=null;if("textbox"===e.question.type)M=r.a.createElement("form",{className:A.root},r.a.createElement(x.a,{name:e.uid,onChange:j,value:e.answers[e.uid],style:d?{}:{border:"1px solid red"},fullWidth:!0}));else if("textarea"===e.question.type)M=r.a.createElement("form",{className:A.root},r.a.createElement(x.a,{name:e.uid,multiline:!0,row:5,variant:"outlined",onChange:j,value:e.answers[e.uid],style:d?{}:{border:"1px solid red"},fullWidth:!0}));else if("select"===e.question.type){var z="undefined"!==typeof e.question.options&&null!==e.question.options,B="undefined"!==typeof e.question.conditionaloptions&&null!==e.question.conditionaloptions,T="undefined"!==typeof e.question["options"+t]&&null!==e.question["options"+t],X=z?(T?e.question["options"+t]:e.question.options).map((function(e){return r.a.createElement(K.a,{value:e,key:e},e)})):null,ee=[];B&&e.question.conditionaloptions.forEach((function(e){D(e.condition)&&(ee=ee.concat(e.options.map((function(e){return r.a.createElement(K.a,{value:e,key:e},e)}))))})),M=r.a.createElement("form",{className:A.root},r.a.createElement(G.a,{name:e.uid,autoWidth:!1,onChange:j,value:e.answers[e.uid]},X,ee),r.a.createElement(x.a,{name:e.uid,onChange:O,value:e.answers[e.uid+"_other"],fullWidth:!0,style:"Other"!==e.answers[e.uid]?{display:"none"}:{}}))}else if("radio"===e.question.type)try{var ae=("undefined"!==typeof e.question["options"+t]&&null!==e.question["options"+t]?e.question["options"+t]:e.question.options).map((function(e){return"string"===typeof e?r.a.createElement(J.a,{value:e,key:e,control:r.a.createElement(H.a,{color:"primary"}),label:e}):"object"===typeof e?r.a.createElement(J.a,{value:e.value,key:e.key,control:r.a.createElement(H.a,{color:"primary"}),label:e.value}):null}));M=r.a.createElement("form",{className:A.root},r.a.createElement(F.a,{name:e.uid,onChange:j,value:e.answers[e.uid]},ae))}catch(_e){}else if("multiselect"===e.question.type){var se="undefined"!==typeof e.question.options&&null!==e.question.options,le="undefined"!==typeof e.question.conditionaloptions&&null!==e.question.conditionaloptions,ue="undefined"!==typeof e.question["options"+t]&&null!==e.question["options"+t],Oe=se?(ue?e.question["options"+t]:e.question.options).map((function(t){return r.a.createElement("div",null,r.a.createElement(J.a,{control:r.a.createElement(Q.a,{color:"primary",value:t,name:t,checked:!(!e.answers[e.uid]||void 0===e.answers[e.uid]||null===e.answers[e.uid]||!Array.isArray(e.answers[e.uid]))&&-1!==e.answers[e.uid].indexOf(t),onChange:function(t){return k(t,e.uid)}}),label:t,key:t}),"Other"===t&&Array.isArray(e.answers[e.uid])&&-1!==e.answers[e.uid].indexOf(t)?r.a.createElement(x.a,{name:e.uid,onChange:O,value:e.answers[e.uid+"_other"],fullWidth:!0}):null)})):null,ke=[];le&&e.question.conditionaloptions.forEach((function(t){D(t.condition)&&(ke=ke.concat(t.options.map((function(t){return r.a.createElement(J.a,{control:r.a.createElement(Q.a,{color:"primary",value:t,name:t,checked:-1!==e.answers[e.uid].indexOf(t),onChange:function(t){return k(t,e.uid)}}),label:t,key:t})}))))})),M=r.a.createElement("form",{className:A.root},r.a.createElement($.a,{name:e.uid,color:"primary"},ke,Oe))}else if("geolocation"===e.question.type){var xe="undefined"===typeof e.answers[e.uid]||null===e.answers[e.uid]||""===e.answers[e.uid]||e.answers[e.uid].length<2?"":"["+e.answers[e.uid][0]+", "+e.answers[e.uid][1]+"]";M=r.a.createElement("form",{className:A.root},r.a.createElement("div",{style:{padding:"10px"}},xe),r.a.createElement(C.a,{variant:"outlined",color:"primary",startIcon:r.a.createElement(Z.a,null),onClick:function(){return b(e.uid)}},"Detect"))}else if("image"===e.question.type)M=r.a.createElement("form",{className:A.root},q?null:r.a.createElement(C.a,{variant:"outlined",color:"primary",startIcon:r.a.createElement(te.a,null),onClick:function(){return function(e){return w.apply(this,arguments)}(e.uid)}},"Open Camera"),r.a.createElement("img",{id:"camera image",src:e.answers[e.uid].dataUrl,alt:"",width:"20%",height:"20%",style:{padding:"5px",width:"20%",height:"20%",objectFit:"cover"}}));else if("qrcode"===e.question.type)M=r.a.createElement("form",{className:A.root},r.a.createElement(re.a,{onError:L,onScan:_,style:{width:"100%"}}),r.a.createElement("p",null,e.answers[e.uid]));else if("barcode"===e.question.type)console.log(e.uid),M=r.a.createElement("form",{className:A.root},r.a.createElement(ie.a,{onScan:_,timeBeforeScanTest:"0",onError:L,scanKeyCode:"13"}));else if("grid"===e.question.type){void 0===s.rowcount&&void 0!==e.question.rows.count&&l(Object(i.a)({},s,{rowcount:e.question.rows.count}));var Ce=e.question.cols.map((function(e){return r.a.createElement(me.a,null,r.a.createElement("div",null,e.text))})),Se=function(t){return e.question.cols.map((function(n,a){var o=e.uid+"_row"+t+"_col"+a;return r.a.createElement(me.a,{style:{marginLeft:"0px",paddingLeft:"0px"}},r.a.createElement(je,{uid:o,id:o,key:o,question:n,subquestion:!0,store:N,answers:e.answers,unsubscribe:e.unsubscribe,submitState:e.submitState,questionLookup:[]}))}))},qe=void 0===e.question.rows.count?e.question.rows.map((function(e,t){return r.a.createElement(ye.a,{nowrap:!0,style:{width:"100%"}},r.a.createElement(me.a,null,r.a.createElement("div",null,e.text)),Se(t))})):Array.from(Array(s.rowcount).keys()).map((function(e){return r.a.createElement(ye.a,null,r.a.createElement(me.a,null,r.a.createElement("div",null,e+1)),Se(e))}));M=r.a.createElement("form",{className:A.root},r.a.createElement(he.a,null,r.a.createElement(de.a,{"aria-label":"customized table"},r.a.createElement(fe.a,null,r.a.createElement(ye.a,null,r.a.createElement(me.a,{debug:!0}," "),Ce)),r.a.createElement(pe.a,null,qe))),void 0!==e.question.rows.addmore&&e.question.rows.addmore?r.a.createElement(C.a,{variant:"outlined",color:"primary",onClick:function(){l(Object(i.a)({},s,{rowcount:s.rowcount+1}))}},"Add Row"):null)}else"hidden"===e.question.type&&("geolocation"===e.question.value?b(e.uid):"timestamp"===e.question.value?(P=e.uid,e.answers[P]=(new Date).toUTCString()):"uniquenumber"===e.question.value?function(t){e.answers[t]=Math.floor(1e5*Math.random())}(e.uid):"userid"===e.question.value&&function(t){e.answers[t]=s.user.username}(e.uid),M=r.a.createElement("form",null,r.a.createElement("input",{type:"hidden",value:e.answers[e.uid]})));return r.a.createElement("div",Object(h.a)({className:"question",style:"hidden"!==e.question.type&&s.valid?{}:{display:"none"}},"style",y&&e.submitState?{border:"1px solid red"}:{}),r.a.createElement("div",{className:"question text",style:void 0!==e.subquestion?{position:"absolute",overflow:"hidden",clip:"rect(0 0 0 0)",height:"1px",width:"1px",margin:"-1px",padding:"0",border:"0"}:{display:"flex",flexDirection:"row",justifyContent:"flex-start"}},e.question["text".concat(t)]?e.question["text".concat(t)]:e.question.text,U,"  ",R),r.a.createElement("div",{className:"question help",style:void 0!==e.subquestion?{position:"absolute",overflow:"hidden",clip:"rect(0 0 0 0)",height:"1px",width:"1px",margin:"-1px",padding:"0",border:"0"}:{}},e.question["help".concat(t)]?e.question["help".concat(t)]:e.question.help),r.a.createElement("div",{className:"question options"},M))}function Oe(e){var t="undefined"!==typeof e.questions&&null!==e.questions?e.questions.map((function(t,n){return null===t?null:r.a.createElement(je,{uid:"s"+e.sectionId+"_q"+n,id:"undefined"!==typeof t.id&&null!==t.id&&""!==t.id?t.id:"s"+e.sectionId+"_q"+n,key:"Question "+n,question:t,store:e.store,answers:e.answers,questionLookup:e.questionLookup,unsubscribe:e.unsubscribe,subscribe:e.subscribe,submitState:e.submitState})})):[];return r.a.createElement(B,{value:e.value,index:e.index,style:{textColor:"red"}},r.a.createElement("div",{className:"surveyform"},t))}var ke=n(782),xe=n(778);function Ce(e){return r.a.createElement(xe.a,Object.assign({elevation:6,variant:"filled"},e))}B.propTypes={children:E.a.node,index:E.a.any.isRequired,value:E.a.any.isRequired};var Se=Object(w.a)((function(e){return{root:{flexGrow:1,width:"100%",backgroundColor:"theme.palette.background.paper",top:0}}}));function qe(e){var t=Se(),n=r.a.useState(0),a=Object(v.a)(n,2),o=a[0],s=a[1],i=r.a.useState(!1),l=Object(v.a)(i,2),u=l[0],c=l[1],d=r.a.useState("_en"),p=Object(v.a)(d,1)[0],m=r.a.useState(""),h=Object(v.a)(m,2),f=h[0],y=h[1],b=r.a.useState(!1),E=Object(v.a)(b,2),w=E[0],C=E[1];r.a.useEffect((function(){e.subscribe("temp",S)}),[]);var S=function(e,t){c(!0),y(e),C(!0)};function q(){C(!1)}var _="undefined"!==typeof e.survey.sections&&null!==e.survey.sections?e.survey.sections.map((function(e,t){return null===e?null:r.a.createElement(k.a,Object.assign({label:"undefined"!==typeof e.title?e.title:""},{id:"scrollable-auto-tab-".concat(t)},{key:"Section "+t,style:t===f?{color:"red"}:{}}))})):[],L="undefined"!==typeof e.survey["title"+p]&&null!==e.survey["title"+p]?e.survey["title"+p]:e.survey.title,D="undefined"!==typeof e.survey["instructions"+p]&&null!==e.survey["instructions"+p]?e.survey["instructions"+p]:e.survey.instructions,I="undefined"!==typeof e.survey["header"+p]&&null!==e.survey["header"+p],N="undefined"!==typeof e.survey.header&&null!==e.survey.header,A=I?e.survey["header"+p]:N?e.survey.header:"Home",U="undefined"!==typeof e.survey["conclusion"+p]&&null!==e.survey["conclusion"+p]?e.survey["conclusion"+p]:e.survey.conclusion,R=[r.a.createElement(k.a,{label:A,key:A})].concat(Object(g.a)(_),[r.a.createElement(k.a,{label:"Thanks",key:"Thanks"})]),M=r.a.createElement(B,{value:o,index:0},r.a.createElement("div",{className:"surveyform"},"undefined"!==typeof e.survey.logo&&null!==e.survey.logo?r.a.createElement("img",{src:e.survey.logo,alt:"survey logo"}):null,"undefined"!==typeof L&&null!==L?r.a.createElement("h2",null,L):null),"undefined"!==typeof D&&null!==D?r.a.createElement("div",null,r.a.createElement(x.a,{id:"instructions",fullWidth:!0,margin:"normal",disabled:!0,multiline:!0,value:D,variant:"filled"})):null),z=r.a.createElement(B,{value:o,index:R.length-1},r.a.createElement("div",{className:"surveyform"},"undefined"!==typeof U&&null!==U?r.a.createElement("h2",null,U):null)),T="undefined"!==typeof e.survey.sections&&null!==e.survey.sections?e.survey.sections.map((function(t,n){return null===t?null:r.a.createElement(Oe,{questions:t.questions,key:"Section "+n,value:o,index:n+1,store:e.store,answers:e.answers,questionLookup:e.questionLookup,unsubscribe:e.unsubscribe,subscribe:e.subscribe,submitState:u,sectionId:n})})):[],W=e.editor?"viewer":"viewer1";return console.log(e.submitState),r.a.createElement("div",null,r.a.createElement("div",{className:W},r.a.createElement("div",{className:t.root},r.a.createElement(j.a,{position:"sticky",color:"default"},r.a.createElement(O.a,{value:o,onChange:function(e,t){s(t)},indicatorColor:"primary",textColor:"primary",variant:"scrollable",scrollButtons:"auto"},R)),M,T,z)),r.a.createElement(P,{current:o,total:R.length,goto:function(e){s(e)},editor:e.editor,submit:e.submit,submitState:u}),r.a.createElement(ke.a,{open:w,anchorOrigin:{vertical:"bottom",horizontal:"right"},autoHideDuration:6e3,onClose:q},r.a.createElement(Ce,{severity:"warning",onClose:q},"Please fill all mandatory questions before submission!")))}var _e=n(23),Le=function(e){function t(e){var n;Object(l.a)(this,t),n=Object(c.a)(this,Object(d.a)(t).call(this,e));var a={},r={},o=new Map;return n.props.json.survey.sections.forEach((function(e,t){"undefined"!==typeof e.questions&&null!==e.questions&&e.questions.forEach((function(e,n){a["s"+t+"_q"+n]="","undefined"!==typeof e.id&&null!==e.id&&""!==e.id&&(r[e.id]="s"+t+"_q"+n)}))})),n.state=a,n.store=n.store.bind(Object(p.a)(n)),n.submit=n.submit.bind(Object(p.a)(n)),n.unsubscribe=n.unsubscribe.bind(Object(p.a)(n)),n.subscribe=n.subscribe.bind(Object(p.a)(n)),n.publish=n.publish.bind(Object(p.a)(n)),n.questionLookup=r,n.invalidquestions=[],n.questionpub=o,n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"publish",value:function(e,t){this.questionpub.forEach((function(n,a){n(e,t)}))}},{key:"subscribe",value:function(e,t){t&&this.questionpub&&this.questionpub.set(e,t)}},{key:"submit",value:function(){var e=this,t=this.props.json.survey.sections.every((function(t,n){t.questions.every((function(t,a){var r="s"+n+"_q"+a;return(void 0!==e.state[r]&&""!==e.state[r]||!t.mandatory||void 0===t.mandatory||!0!==t.mandatory||-1!==e.invalidquestions.indexOf(r))&&!(void 0!==e.state[r]&&""!==e.state[r]&&-1===e.invalidquestions.indexOf(r)&&"textbox"===t.type&&void 0!==t.format&&null!==t.format&&""!==t.format&&void 0!==ge[t.format]&&null!==ge[t.format]&&""!==ge[t.format]&&!new RegExp(ge[t.format]).test(e.state[r]))||(e.publish(n,a),!1)}))}));return console.log(t),!!t&&((0,Object(_e.useIndexedDB)("surveys").add)({survey:this.props.json.survey,answers:this.state}).then((function(t){console.log("ID Generated: ",t),e.props.isStale(!1)}),(function(e){console.log(e)})),this.publish("",""),!0)}},{key:"store",value:function(e,t){this.props.isStale(!0),this.setState(Object(i.a)({},this.state,Object(h.a)({},e,t)))}},{key:"unsubscribe",value:function(e,t){t&&-1===this.invalidquestions.indexOf(e)?this.invalidquestions.push(e):t||-1===this.invalidquestions.indexOf(e)||this.invalidquestions.splice(this.invalidquestions.indexOf(e))}},{key:"render",value:function(){return"undefined"===typeof this.props.json.survey?r.a.createElement("div",{style:{color:"red"}},"Error: ",r.a.createElement("b",null,"survey")," object is missing "):"undefined"===typeof this.props.json.survey.id?r.a.createElement("div",{style:{color:"red"}},"Error: ",r.a.createElement("b",null,"survey id")," is missing "):null===this.props.json.survey.id?r.a.createElement("div",{style:{color:"red"}},"Error: ",r.a.createElement("b",null,"survey id")," is blank "):"undefined"===typeof this.props.json.survey.version?r.a.createElement("div",{style:{color:"red"}},"Error: ",r.a.createElement("b",null,"survey version")," is missing "):null===this.props.json.survey.version?r.a.createElement("div",{style:{color:"red"}},"Error: ",r.a.createElement("b",null,"survey version")," is blank "):r.a.createElement("div",null,r.a.createElement(qe,{survey:this.props.json.survey,store:this.store,answers:this.state,questionLookup:this.questionLookup,editor:this.props.editor,submit:this.submit,unsubscribe:this.unsubscribe,subscribe:this.subscribe}))}}]),t}(r.a.Component),De=n(71),Ie=n(49),Ne=n(19),Ae=function(e){return function(t,n){"undefined"===typeof e?Ne.b.currentAuthenticatedUser().then((function(e){t({type:"AUTH_SUCCESS",data:e})})).catch((function(e){t({type:"LOGIN_FAILED",err:e})})):Ne.b.signIn(e.username,e.password).then((function(e){t({type:"LOGIN_SUCCESS",data:e})})).catch((function(e){console.log(e),t({type:"LOGIN_FAILED",err:e})}))}},Ue=n(766),Re=n(234),Pe=n(785),Me=n(120),ze=function(e){(0,Object(_e.useIndexedDB)("conf").getAll)().then((function(t){0!==t.length&&0!==t.filter((function(t){return t.id===e})).length||function(e){var t=Object(_e.useIndexedDB)("conf").add;Ne.d.get(e).catch((function(e){return console.log(e)})).then((function(n){fetch(n).then((function(e){return e.text()})).then((function(n){t({id:e,text:n}).then((function(e){console.log(e)}),(function(e){console.log(e)}))}))}),(function(e){console.log(e)}))}(e)}),(function(e){console.log(e)}))},Be=function(){Me.a.map((function(e){return ze(e.yaml)}))},Te=function(){var e=Object(Y.a)(W.a.mark((function e(t,n,a){var r,o;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.survey.sections.map((function(e,a){e.questions.map((function(e,r){var o=t.answers["s"+a+"_q"+r];if("image"===e.type&&void 0!==o&&o.dataUrl&&""!==o.dataUrl){var s=o.format,i=t.survey.id+"/"+n+"_"+e.id+"_"+(new Date).getTime()+"."+s;Ne.d.put(i,o.dataUrl,{contentType:"image/"+s}).catch((function(e){return console.log(e)})).then((function(e){t.answers["s"+a+"_q"+r]=e}))}}))}));case 2:r=Object(_e.useIndexedDB)("surveys"),o=r.deleteRecord,Ne.a.post("api","/survey/1",{body:t}).then((function(e){o(t.id).then((function(e){a()})).catch((function(e){console.log(e.response)}))}));case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),We=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={surveys:[]},n.handleClick=n.handleClick.bind(Object(p.a)(n)),n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"handleClick",value:function(e){this.props.processURL(e)}},{key:"componentDidMount",value:function(){this.setState({surveys:Me.a}),Be(),window.addEventListener("beforeunload",(function(){console.log("123.........1")})),window.addEventListener("popstate",(function(){console.log("234.........1")})),window.onpopstate=function(e){console.log("pop state 1 ")}}},{key:"render",value:function(){var e=this,t={maxWidth:"50%",margin:"10px 10px",padding:"10px",width:"100%",paddingTop:"20px"},n=this.state.surveys.map((function(n,a){return r.a.createElement(Re.a,{key:a,style:t},r.a.createElement(Ue.a,{container:!0,spacing:1,style:{cursor:"pointer"},onClick:function(){return e.handleClick(n.yaml)}},r.a.createElement(Ue.a,{item:!0},r.a.createElement(Pe.a,{src:n.icon},n.category)),r.a.createElement(Ue.a,{item:!0,xs:!0,zeroMinWidth:!0},r.a.createElement(M.a,null,n.name))))}));return r.a.createElement(Ue.a,{container:!0,direction:"column",style:{width:"100%",height:"95vh",border:"1px solid green",display:"flex",flexDirection:"row",justifyContent:"center",overflowY:"scroll",padding:"30px"}},n)}}]),t}(r.a.Component),Ye=n(38),Ge=n(783),Ke=n(754),Fe=n(767),He=n(686),Je=n(768),$e=n(769),Qe=n(228),Ve=n.n(Qe),Xe=n(227),Ze=n.n(Xe),et=n(147),tt=n.n(et),nt=n(226),at=n.n(nt),rt={languages:[{id:"_en",text:"English"},{id:"_tn",text:"Tamil"},{id:"_te",text:"Telugu"},{id:"_hn",text:"Hindi"},{id:"_kn",text:"Kannada"}]},ot=n(685),st=n(224),it=n.n(st),lt=n(225),ut=n.n(lt),ct=Object(w.a)((function(e){return{root:{"& > span":{margin:e.spacing(2)}},list:{width:250},selected:{color:"red"},drawerHeader:Object(i.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar,{justifyContent:"flex-start"})}}));var dt=Object(Ie.b)((function(e){return{user:e.signIn.user,userlang:e.signIn.userlang}}),(function(e){return{signOut:function(){return e((function(e,t){Ne.b.signOut().then((function(t){e({type:"LOGOUT_SUCCESS",data:t})})).catch((function(t){e({type:"LOGOUT_FAILED",err:t})}))}))}}}))((function(e){var t=ct(),n=Object(Ye.a)(),a=r.a.useState({user:e.user,userlang:e.userlang,surveycount:""}),o=Object(v.a)(a,2),s=o[0],l=o[1],u=Object(_e.useIndexedDB)("surveys").getAll,c=Object(_e.useIndexedDB)("user").getByID;r.a.useEffect((function(){c(0).then((function(e){e&&l(Object(i.a)({},s,{userlang:e.lang}))}),(function(e){console.log(e)}))}),[]);var d=function(){u().then((function(e){l(Object(i.a)({},s,{surveycount:""+e.length}))}))},p=function(t){var n,a;l(Object(i.a)({},s,{user:e.user,userlang:t})),n=e.user,a=t,(0,Object(_e.useIndexedDB)("user").update)({id:0,username:n.username,lang:a}).then((function(e){}),(function(e){console.log(e)}))},m=function(e,t){return function(n){("keydown"!==n.type||"Tab"!==n.key&&"Shift"!==n.key)&&(l(Object(i.a)({},s,Object(h.a)({},e,t))),u().then((function(n){l(Object(i.a)({},s,Object(h.a)({surveycount:""+n.length},e,t)))}),(function(n){l(Object(i.a)({},s,Object(h.a)({},e,t)))})))}};return r.a.createElement("div",{className:t.root},r.a.createElement(Ve.a,{color:"secondary",onClick:m("right",!0)}),r.a.createElement(Ge.a,{anchor:"right",open:s.right,onClose:m("right",!1)},r.a.createElement("div",{className:t.list,role:"presentation"},r.a.createElement("div",{className:t.drawerHeader},r.a.createElement(ot.a,{onClick:m("right",!1)},"rtl"===n.direction?r.a.createElement(it.a,null):r.a.createElement(ut.a,null))),r.a.createElement(Fe.a,null),r.a.createElement(Ke.a,null,rt.languages.map((function(e,t){return r.a.createElement(He.a,{button:!0,key:e.id,style:s.userlang===e.id?{color:"red"}:null,onClick:function(){return p(e.id)}},r.a.createElement(Je.a,null,r.a.createElement(at.a,null)),r.a.createElement($e.a,{primary:e.text}))}))),r.a.createElement(Fe.a,null),r.a.createElement(Ke.a,null,r.a.createElement(He.a,{button:!0,key:"Sync1",onClick:function(){return function(e,t){return console.log(e),(0,Object(_e.useIndexedDB)("surveys").getAll)().then((function(n){n.map((function(n){Te(n,e,t)}))})),null}(s.user.username,d)}},r.a.createElement(Je.a,null,r.a.createElement(tt.a,null)),r.a.createElement($e.a,{primary:"Sync Responses ("+s.surveycount+")"})),r.a.createElement(He.a,{button:!0,key:"Sync2",onClick:function(){return Be()}},r.a.createElement(Je.a,null,r.a.createElement(tt.a,null)),r.a.createElement($e.a,{primary:"Sync Questionnaires"})),r.a.createElement(He.a,{button:!0,key:"exit",onClick:e.signOut},r.a.createElement(Je.a,null,r.a.createElement(Ze.a,null)),r.a.createElement($e.a,{primary:"Logout"}))))))})),pt=n(230),mt=n.n(pt),ht=n(770),ft=n(773),yt=n(772),gt=n(771),vt=n(89),bt=n.n(vt);function Et(e){return r.a.createElement(bt.a,{cancel:'[class*="MuiDialogContent-root"]'},r.a.createElement(Re.a,e))}var wt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={surveys:[],open:!1,stale:!1},n.isStale=n.isStale.bind(Object(p.a)(n)),n.handleCancel=n.handleCancel.bind(Object(p.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(p.a)(n)),n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.signIn()}},{key:"isStale",value:function(e){this.setState(Object(i.a)({},this.state,{stale:e}))}},{key:"handleCancel",value:function(){this.setState(Object(i.a)({},this.state,{open:!1}))}},{key:"handleSubmit",value:function(){this.props.processYAML(""),this.setState(Object(i.a)({},this.state,{open:!1}))}},{key:"render",value:function(){var e=this;return!1!==this.props.editor||"undefined"!==typeof this.props.user.username&&null!==this.props.user.username&&""!==this.props.user.username?r.a.createElement("div",null,r.a.createElement("div",{className:"topbar"},r.a.createElement("div",{style:{float:"left",height:"50px",display:"flex",flexDirection:"row",alignItems:"center"}},!1===this.props.editor&&null!==this.props.json&&""!==this.props.json?r.a.createElement(mt.a,{height:"40px",style:{paddingLeft:"5px",cursor:"pointer"},onClick:function(){e.state.stale?e.setState(Object(i.a)({},e.state,{open:!0})):e.props.processYAML("")}}):null,r.a.createElement("img",{src:"undefined"!==typeof this.props.json&&null!==this.props.json&&""!==this.props.json&&"undefined"!==typeof this.props.json.survey&&"undefined"!==typeof this.props.json.survey.logo&&null!==this.props.json.survey.logo&&""!==this.props.json.survey.logo?this.props.json.survey.logo:this.props.logo,alt:"Surveykshan",height:"40px",style:{padding:"5px",objectFit:"cover"}})),r.a.createElement("div",{style:{color:"white",fontSize:"medium",float:"left"}},"undefined"!==typeof this.props.json&&null!==this.props.json&&""!==this.props.json&&"undefined"!==typeof this.props.json.survey&&"undefined"!==typeof this.props.json.survey.title&&null!==this.props.json.survey.title&&""!==this.props.json.survey.title?this.props.json.survey.title:"Surveykshan"),r.a.createElement("div",{style:{float:"right",paddingRight:30,color:"white",fontSize:"small",alignItems:"right",align:"right"}},r.a.createElement(dt,null))),"undefined"!==typeof this.props.json&&null!==this.props.json&&""!==this.props.json?r.a.createElement(Le,{json:this.props.json,setNav:this.setNav,editor:this.props.editor,isStale:this.isStale}):"undefined"!==typeof this.props.err&&null!==this.props.err&&""!==this.props.err?r.a.createElement("div",{style:{color:"red"}},"Error: ",this.props.err.message," at line number ",this.props.err.parsedLine,"  "):!1===this.props.editor&&"undefined"!==typeof this.props.user.username&&null!==this.props.user.username&&""!==this.props.user.username?r.a.createElement(We,{processURL:this.props.processURL}):null,r.a.createElement(ht.a,{open:this.state.open,disableBackdropClick:!0,onClose:this.handleCancel,PaperComponent:Et},r.a.createElement(gt.a,{style:{cursor:"move"},id:"draggable-dialog-title"},r.a.createElement("b",null,"The current questionnaire is not saved !!")),r.a.createElement(yt.a,null,"Moving out loses the data! Are you sure you want to go back ?"),r.a.createElement(ft.a,null,r.a.createElement(C.a,{className:"bbutton",onClick:this.handleSubmit}," Yes "),r.a.createElement(C.a,{className:"bbutton",style:{color:"white",backgroundColor:"rgb(74, 119, 229)",width:"auto"},onClick:this.handleCancel}," Cancel ")))):r.a.createElement(De.a,{to:"/signin"})}}]),t}(r.a.Component),jt=Object(Ie.b)((function(e){return{user:e.signIn.user}}),(function(e){return{signIn:function(){return e(Ae())}}}))(wt),Ot=n(121),kt=n.n(Ot),xt=n(122),Ct=n.n(xt),St=n(123),qt=n.n(St),_t=n(235),Lt=n(774);function Dt(e){return r.a.createElement(bt.a,{cancel:'[class*="MuiDialogContent-root"]'},r.a.createElement(Re.a,e))}Object(_e.initDB)({name:"SurveyDB",version:1,objectStoresMeta:[{store:"surveys",storeConfig:{keyPath:"id",autoIncrement:!0},storeSchema:[]},{store:"user",storeConfig:{keyPath:"id",autoIncrement:!0},storeSchema:[]},{store:"conf",storeConfig:{keyPath:"id",autoIncrement:!0},storeSchema:[]}]});var It=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).refName=r.a.createRef(),n.process=n.process.bind(Object(p.a)(n)),n.handleKeyDown=n.handleKeyDown.bind(Object(p.a)(n)),n.handleChange=n.handleChange.bind(Object(p.a)(n)),n.handleCancel=n.handleCancel.bind(Object(p.a)(n)),n.showDialog=n.showDialog.bind(Object(p.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(p.a)(n)),n.state={open:!1,loading:!1,category:"",survey:"",selection:"",username:"",lang:"_en"},(0,Object(_e.useIndexedDB)("user").getByID)(0).then((function(e){e&&(n.state={open:!1,loading:!1,category:"",survey:"",selection:"",username:e.username,lang:e.lang})}),(function(e){console.log(e)})),n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"process",value:function(){var e=this.refName.current.editor.getValue();this.props.processYAML(e)}},{key:"handleKeyDown",value:function(e){13===e.keyCode&&this.handleSubmit()}},{key:"handleChange",value:function(e){this.setState(Object(i.a)({},this.state,Object(h.a)({},e.target.id,e.target.value)))}},{key:"handleCancel",value:function(){this.setState(Object(i.a)({},this.state,{open:!1,loading:!1,selection:""}))}},{key:"handleSubmit",value:function(){var e=this;"save"===this.state.selection?(this.setState(Object(i.a)({},this.state,{loading:!0})),Ne.d.put(this.state.category+"/"+this.state.survey+".yml",this.props.yaml,{contentType:"text/plain"}).catch((function(e){return console.log(e)})).then((function(t){e.setState(Object(i.a)({},e.state,{open:!1,loading:!1}))}))):(this.setState(Object(i.a)({},this.state,{loading:!0})),Ne.d.get(this.state.category+"/"+this.state.survey+".yml",{contentType:"text/plain"}).catch((function(e){return console.log(e)})).then((function(t){e.setState(Object(i.a)({},e.state,{open:!1,loading:!1})),e.props.processURL(t)})))}},{key:"showDialog",value:function(e){this.setState(Object(i.a)({},this.state,{open:!0,selection:e}))}},{key:"render",value:function(){var e=this,t={username:this.state.username,lang:this.state.lang};return r.a.createElement(ue,{value:{user:t}},r.a.createElement("div",{className:"App",style:{height:this.props.height,width:this.props.width}},r.a.createElement("div",{className:"leftpane"},r.a.createElement("div",{className:"topbar"},r.a.createElement("div",{className:"title"},r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement("img",{src:this.props.logo,alt:"Surveykshan",height:"40px",style:{padding:"5px"}})),r.a.createElement("div",null,r.a.createElement("div",{style:{color:"white",fontSize:"x-large",paddingLeft:"5px"}},"Surveykshan"),r.a.createElement("div",{style:{color:"white",fontSize:"small",textAlign:"left",paddingLeft:"5px",paddingBottom:"5px"}},"Create surveys in a jiffy"))),r.a.createElement("div",{style:{margin:"20px"}},r.a.createElement(C.a,{variant:"contained",startIcon:r.a.createElement(kt.a,null),style:{margin:"10px"},size:"small",onClick:function(){return e.showDialog("open")}},"Open"),r.a.createElement(C.a,{variant:"contained",startIcon:r.a.createElement(Ct.a,null),style:{margin:"10px"},size:"small",onClick:function(){return e.showDialog("save")}},"Save"),r.a.createElement(C.a,{variant:"contained",startIcon:r.a.createElement(qt.a,null),style:{margin:"10px"},size:"small",onClick:function(){return e.showDialog("save")}},"Save As"))),r.a.createElement("div",null,r.a.createElement(y.a,{mode:"yaml",theme:"monokai",name:"ace-editor",height:"92vh",width:"50vw",fontSize:14,focus:!0,showPrintMargin:!1,editorProps:{$blockScrolling:1/0},ref:this.refName,value:this.props.yaml,wrapEnabled:!0,placeholder:"",onChange:this.process}))),r.a.createElement("div",{className:"rightpane"},r.a.createElement(jt,Object.assign({},this.props,{editor:!0}))),r.a.createElement(ht.a,{open:this.state.open,disableBackdropClick:!0,onClose:this.handleCancel,PaperComponent:Dt},r.a.createElement(gt.a,{style:{cursor:"move",borderBottom:"1px groove lightgray"},id:"draggable-dialog-title"},r.a.createElement("b",null,"Please provide the following details")),r.a.createElement(yt.a,null,r.a.createElement(_t.a,{in:this.state.loading,unmountOnExit:!0,style:{transitionDelay:this.state.loading?"800ms":"0ms"}},r.a.createElement(Lt.a,null)),r.a.createElement(x.a,{autoFocus:!0,key:"category",fullWidth:!0,id:"category",label:"Category",onChange:this.handleChange,value:this.state.category,required:!0}),r.a.createElement(x.a,{key:"survey",fullWidth:!0,id:"survey",label:"Survey",onChange:this.handleChange,value:this.state.survey,onKeyDown:this.handleKeyDown,required:!0})),r.a.createElement(ft.a,null,r.a.createElement(C.a,{className:"bbutton",onClick:this.handleCancel}," Cancel "),r.a.createElement(C.a,{className:"bbutton",onClick:this.handleSubmit,style:{color:"white",backgroundColor:"rgb(74, 119, 229)",width:"auto"}}," Done ")))))}}]),t}(r.a.Component),Nt=function(e){function t(e){var n;Object(l.a)(this,t),n=Object(c.a)(this,Object(d.a)(t).call(this,e));var a={},r={};return n.props.json.survey.sections.forEach((function(e,t){"undefined"!==typeof e.questions&&null!==e.questions&&e.questions.forEach((function(e,n){a["s"+t+"_q"+n]="","undefined"!==typeof e.id&&null!==e.id&&""!==e.id&&(r[e.id]="s"+t+"_q"+n)}))})),n.state=a,n.store=n.store.bind(Object(p.a)(n)),n.submit=n.submit.bind(Object(p.a)(n)),n.questionLookup=r,n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"submit",value:function(){console.log("&&& inside submit "+JSON.stringify(this.state)),(0,Object(_e.useIndexedDB)("surveys").add)({survey:this.props.json.survey,answers:this.state}).then((function(e){console.log("ID Generated: ",e)}),(function(e){console.log(e)}))}},{key:"store",value:function(e,t){this.setState(Object(i.a)({},this.state,Object(h.a)({},e,t)))}},{key:"render",value:function(){return console.log(this.state),"undefined"===typeof this.props.json.survey?r.a.createElement("div",{style:{color:"red"}},"Error: ",r.a.createElement("b",null,"survey")," object is missing "):"undefined"===typeof this.props.json.survey.id?r.a.createElement("div",{style:{color:"red"}},"Error: ",r.a.createElement("b",null,"survey id")," is missing "):null===this.props.json.survey.id?r.a.createElement("div",{style:{color:"red"}},"Error: ",r.a.createElement("b",null,"survey id")," is blank "):"undefined"===typeof this.props.json.survey.version?r.a.createElement("div",{style:{color:"red"}},"Error: ",r.a.createElement("b",null,"survey version")," is missing "):null===this.props.json.survey.version?r.a.createElement("div",{style:{color:"red"}},"Error: ",r.a.createElement("b",null,"survey version")," is blank "):(console.log(this.props.json.survey),console.log(this.store),console.log(this.state),console.log(this.questionLookup),console.log(this.props.editor),console.log(this.submit),r.a.createElement("div",null))}}]),t}(r.a.Component),At=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={surveys:[]},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.props.signIn()}},{key:"render",value:function(){return console.log(this.props.user.username),!1!==this.props.editor||"undefined"!==typeof this.props.user.username&&null!==this.props.user.username&&""!==this.props.user.username?r.a.createElement("div",null,r.a.createElement("div",{className:"topbar"},r.a.createElement("div",{style:{float:"left",height:"50px",width:"50px"}},r.a.createElement("img",{src:"undefined"!==typeof this.props.json&&"undefined"!==typeof this.props.json.survey&&"undefined"!==typeof this.props.json.survey.logo&&null!==this.props.json.survey.logo&&""!==this.props.json.survey.logo?this.props.json.survey.logo:this.props.logo,alt:"Surveykshan",height:"40px",style:{padding:"5px",objectFit:"cover"}})),r.a.createElement("div",{style:{color:"white",fontSize:"medium",paddingLeft:"20px",float:"left"}},"undefined"!==typeof this.props.json&&"undefined"!==typeof this.props.json.survey&&"undefined"!==typeof this.props.json.survey.title&&null!==this.props.json.survey.title&&""!==this.props.json.survey.title?this.props.json.survey.title:"Surveykshan"),r.a.createElement("div",{style:{float:"right",paddingRight:30,color:"white",fontSize:"small",alignItems:"right",align:"right"}},r.a.createElement(dt,null))),"undefined"!==typeof this.props.json&&null!==this.props.json&&""!==this.props.json?r.a.createElement(Nt,{json:this.props.json,setNav:this.setNav,editor:this.props.editor}):"undefined"!==typeof this.props.err&&null!==this.props.err&&""!==this.props.err?r.a.createElement("div",{style:{color:"red"}},"Error: ",this.props.err.message," at line number ",this.props.err.parsedLine,"  "):!1===this.props.editor&&"undefined"!==typeof this.props.user.username&&null!==this.props.user.username&&""!==this.props.user.username?r.a.createElement(We,{processURL:this.props.processURL}):null):r.a.createElement(De.a,{to:"/signin"})}}]),t}(r.a.Component),Ut=Object(Ie.b)((function(e){return{user:e.signIn.user}}),(function(e){return{signIn:function(){return e(Ae())}}}))(At);function Rt(e){return r.a.createElement(bt.a,{cancel:'[class*="MuiDialogContent-root"]'},r.a.createElement(Re.a,e))}var Pt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).refName=r.a.createRef(),n.process=n.process.bind(Object(p.a)(n)),n.handleKeyDown=n.handleKeyDown.bind(Object(p.a)(n)),n.handleChange=n.handleChange.bind(Object(p.a)(n)),n.handleCancel=n.handleCancel.bind(Object(p.a)(n)),n.showDialog=n.showDialog.bind(Object(p.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(p.a)(n)),n.state={open:!1,loading:!1,category:"",survey:"",selection:"",username:"",lang:"_en"},n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"process",value:function(){var e=this.refName.current.editor.getValue();this.props.processYAML(e)}},{key:"handleKeyDown",value:function(e){13===e.keyCode&&this.handleSubmit()}},{key:"handleChange",value:function(e){this.setState(Object(i.a)({},this.state,Object(h.a)({},e.target.id,e.target.value)))}},{key:"handleCancel",value:function(){this.setState(Object(i.a)({},this.state,{open:!1,loading:!1,selection:""}))}},{key:"handleSubmit",value:function(){var e=this;"save"===this.state.selection?(this.setState(Object(i.a)({},this.state,{loading:!0})),Ne.d.put(this.state.category+"/"+this.state.survey+".yml",this.props.yaml,{contentType:"text/plain"}).catch((function(e){return console.log(e)})).then((function(t){e.setState(Object(i.a)({},e.state,{open:!1,loading:!1}))}))):(this.setState(Object(i.a)({},this.state,{loading:!0})),Ne.d.get(this.state.category+"/"+this.state.survey+".yml",{contentType:"text/plain"}).catch((function(e){return console.log(e)})).then((function(t){e.setState(Object(i.a)({},e.state,{open:!1,loading:!1})),e.props.processURL(t)})))}},{key:"showDialog",value:function(e){this.setState(Object(i.a)({},this.state,{open:!0,selection:e}))}},{key:"render",value:function(){var e=this;return console.log(this.state.yaml),r.a.createElement("div",{className:"App",style:{height:this.props.height,width:this.props.width}},r.a.createElement("div",{className:"leftpane"},r.a.createElement("div",{className:"topbar"},r.a.createElement("div",{className:"title"},r.a.createElement("div",{style:{display:"flex",alignItems:"center"}},r.a.createElement("img",{src:this.props.logo,alt:"Surveykshan",height:"40px",style:{padding:"5px"}})),r.a.createElement("div",null,r.a.createElement("div",{style:{color:"white",fontSize:"x-large",paddingLeft:"5px"}},"Surveykshan"),r.a.createElement("div",{style:{color:"white",fontSize:"small",textAlign:"left",paddingLeft:"5px",paddingBottom:"5px"}},"Create Dashboard in a jiffy"))),r.a.createElement("div",{style:{margin:"20px"}},r.a.createElement(C.a,{variant:"contained",startIcon:r.a.createElement(kt.a,null),style:{margin:"10px"},size:"small",onClick:function(){return e.showDialog("open")}},"Open"),r.a.createElement(C.a,{variant:"contained",startIcon:r.a.createElement(Ct.a,null),style:{margin:"10px"},size:"small",onClick:function(){return e.showDialog("save")}},"Save"),r.a.createElement(C.a,{variant:"contained",startIcon:r.a.createElement(qt.a,null),style:{margin:"10px"},size:"small",onClick:function(){return e.showDialog("save")}},"Save As"))),r.a.createElement("div",null,r.a.createElement(y.a,{mode:"yaml",theme:"monokai",name:"ace-editor",height:"92vh",width:"50vw",fontSize:14,focus:!0,showPrintMargin:!1,editorProps:{$blockScrolling:1/0},ref:this.refName,value:this.props.yaml,wrapEnabled:!0,placeholder:"",onChange:this.process}))),r.a.createElement("div",{className:"rightpane"},r.a.createElement(Ut,Object.assign({},this.props,{editor:!0}))),r.a.createElement(ht.a,{open:this.state.open,disableBackdropClick:!0,onClose:this.handleCancel,PaperComponent:Rt},r.a.createElement(gt.a,{style:{cursor:"move",borderBottom:"1px groove lightgray"},id:"draggable-dialog-title"},r.a.createElement("b",null,"Please provide the following details")),r.a.createElement(yt.a,null,r.a.createElement(_t.a,{in:this.state.loading,unmountOnExit:!0,style:{transitionDelay:this.state.loading?"800ms":"0ms"}},r.a.createElement(Lt.a,null)),r.a.createElement(x.a,{autoFocus:!0,key:"category",fullWidth:!0,id:"category",label:"Category",onChange:this.handleChange,value:this.state.category,required:!0}),r.a.createElement(x.a,{key:"survey",fullWidth:!0,id:"survey",label:"Survey",onChange:this.handleChange,value:this.state.survey,onKeyDown:this.handleKeyDown,required:!0})),r.a.createElement(ft.a,null,r.a.createElement(C.a,{className:"bbutton",onClick:this.handleCancel}," Cancel "),r.a.createElement(C.a,{className:"bbutton",onClick:this.handleSubmit,style:{color:"white",backgroundColor:"rgb(74, 119, 229)",width:"auto"}}," Done "))))}}]),t}(r.a.Component),Mt=n(73),zt=n(93),Bt=n.n(zt),Tt=n(231),Wt=n.n(Tt);var Yt=Object(Ie.b)((function(e){return{user:e.signIn.user,userlang:e.signIn.userlang,challenge:e.signIn.user.challengeName}}),(function(e){return{signIn:function(t){return e(Ae(t))},getCurrentSession:function(){return e(Ae())}}}))((function(e){var t=r.a.useState({username:"prasad@ideafactors.com",password:"testing@1234",newpassword:"",loginError:"",loading:!1,user:{},userlang:e.lang}),n=Object(v.a)(t,2),a=n[0],o=n[1],s=e.getCurrentSession,l=Object(_e.useIndexedDB)("user"),u=l.add,c=l.update;function d(e){o(Object(i.a)({},a,Object(h.a)({},e.target.id,e.target.value)))}function p(){console.log(e.username,e.lang,a.username,a.lang),""===a.username.trim()||""===a.password.trim()?o(Object(i.a)({},a,{loginError:"Email Address and Password cannot be blank"})):(e.signIn(a),console.log(e.lang),o(Object(i.a)({},a,{loading:!0,loginError:"",lang:e.userlang})),""===e.username?u({id:0,username:a.username.trim(),lang:"_en"}).then((function(e){}),(function(e){console.log(e)})):e.username!==a.username.trim()&&c({id:0,username:a.username.trim(),lang:"_en"}).then((function(e){}),(function(e){console.log(e)})))}return r.a.useEffect((function(){s()})),r.a.useEffect((function(){Ne.c.listen("auth",(function(e){console.log(t.event);var t=e.payload;"signIn_failure"===t.event&&(console.log("login failure"),o(Object(i.a)({},a,{username:"",password:"",newpassword:"",loginError:"Invalid Email Address & Password combination. ",loading:!1})))}))}),[e,a]),"undefined"!==typeof e.challenge&&"NEW_PASSWORD_REQUIRED"===e.challenge?(console.log("Redirecting"),r.a.createElement(De.a,{to:"/changepassword"})):"undefined"!==typeof e.user.username&&null!==e.user.username?r.a.createElement(De.a,{to:"/preview"}):r.a.createElement("div",{className:"centered"},r.a.createElement("div",null,r.a.createElement("img",{src:e.logo,alt:"Surveykshan",height:"100px"})),r.a.createElement("div",null,"Surveykshan"),r.a.createElement("div",{style:{color:"red",fontSize:"small",padding:"10px"}},a.loginError),r.a.createElement("div",{style:{padding:"50px"}},r.a.createElement(x.a,{autoFocus:!0,key:"username",fullWidth:!0,id:"username",label:"Email Address",type:"email",autoComplete:"username",onChange:d,value:a.username,required:!0}),r.a.createElement(x.a,{fullWidth:!0,key:"password",id:"password",label:"Password",type:"password",autoComplete:"current-password",onChange:d,value:a.password,onKeyDown:function(e){13===e.keyCode&&p()},required:!0}),r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(_t.a,{in:a.loading,unmountOnExit:!0,style:{transitionDelay:a.loading?"800ms":"0ms"}},r.a.createElement(Lt.a,null)))),r.a.createElement("div",{style:{paddingTop:"5px"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(C.a,{variant:"outlined",onClick:function(){o(Object(i.a)({},a,{username:"",password:"",newpassword:"",loginError:"",loading:!1}))},color:"primary",style:{margin:"20px"}}," Cancel "),r.a.createElement(C.a,{variant:"contained",onClick:p,color:"primary",style:{margin:"20px"}},"Login"))))}));var Gt=Object(Ie.b)((function(e){return console.log(e),{user:e.signIn.user}}),(function(e){return{getCurrentSession:function(){return e(Ae())}}}))((function(e){var t=e.getCurrentSession;r.a.useEffect((function(){t()}));var n=r.a.useState({newpassword:"",loginError:"",loading:!1}),a=Object(v.a)(n,2),o=a[0],s=a[1];function l(){console.log(e.user),Ne.b.completeNewPassword(e.user,o.newpassword)}return r.a.createElement("div",{className:"centered"},r.a.createElement("div",null,r.a.createElement("img",{src:e.logo,alt:"Surveykshan",height:"100px"})),r.a.createElement("div",null,"Surveykshan"),r.a.createElement("div",{style:{color:"red",fontSize:"small",padding:"10px"}},o.loginError),r.a.createElement("div",{style:{padding:"50px"}},r.a.createElement(x.a,{fullWidth:!0,id:"newpassword",label:"New Password",type:"password",autoComplete:"new-password",onChange:function(e){s(Object(i.a)({},o,Object(h.a)({},e.target.id,e.target.value)))},value:o.newpassword,required:!0,onKeyDown:function(e){13===e.keyCode&&l()}}),r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(_t.a,{in:o.loading,unmountOnExit:!0,style:{transitionDelay:o.loading?"800ms":"0ms"}},r.a.createElement(Lt.a,null)))),r.a.createElement("div",{style:{paddingTop:"5px"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement(C.a,{variant:"outlined",onClick:function(){s(Object(i.a)({},o,{newpassword:"",loginError:"",loading:!1}))},color:"primary",style:{margin:"20px"}}," Cancel "),r.a.createElement(C.a,{variant:"contained",onClick:l,color:"primary",style:{margin:"20px"}},"Change Password"))))})),Kt=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).state={yaml:"",json:"",str:"",err:"",height:window.innerHeight,width:window.innerWidth,username:"",lang:"_en"},n.handleResize=n.handleResize.bind(Object(p.a)(n)),n.processYAML=n.processYAML.bind(Object(p.a)(n)),n.processURL=n.processURL.bind(Object(p.a)(n)),n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"processYAML",value:function(e){var t="";try{t=Wt.a.parse(e),this.setState({yaml:e,json:t,str:JSON.stringify(t,void 0,4),err:""})}catch(n){this.setState(Object(i.a)({},this.state,{yaml:e,json:"",err:n}))}}},{key:"processURL",value:function(e){var t=this;(0,Object(_e.useIndexedDB)("conf").getAll)().then((function(n){var a=n.filter((function(t){return t.id===e}));a.length>0&&t.processYAML(a[0].text)}),(function(e){console.log(e)}))}},{key:"processS3URL",value:function(e){var t=this;fetch(e).then((function(e){return e.text()})).then((function(e){t.processYAML(e),console.log(e),console.log(t);try{t.processYAML(e),console.log(e)}catch(n){console.log(n)}}))}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("resize",this.handleResize),(0,Object(_e.useIndexedDB)("user").getByID)(0).then((function(t){t?e.setState(Object(i.a)({},e.state,{username:t.username,lang:t.lang})):e.setState(Object(i.a)({},e.state,{username:"",lang:"_en"}))}),(function(e){console.log(e)}))}},{key:"handleResize",value:function(){this.setState(Object(i.a)({},this.state,{height:window.innerHeight,width:window.innerWidth}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){var e=this,t={username:this.state.username,lang:this.state.lang};return r.a.createElement(ue,{value:t},r.a.createElement(Mt.a,null,r.a.createElement(De.d,null,r.a.createElement(De.b,{exact:!0,path:"/"},r.a.createElement(De.a,{to:"/signin"})),r.a.createElement(De.b,{exact:!0,path:"/signin",render:function(t){return r.a.createElement(Yt,Object.assign({},e.state,{logo:Bt.a}))}}),r.a.createElement(De.b,{exact:!0,path:"/changepassword",render:function(t){return r.a.createElement(Gt,Object.assign({},e.state,{logo:Bt.a}))}}),r.a.createElement(De.b,{exact:!0,path:"/preview",render:function(t){return r.a.createElement(jt,Object.assign({},e.state,{logo:Bt.a,height:e.state.height,width:e.state.width,processYAML:e.processYAML,processURL:e.processURL,yaml:e.state.yaml,json:e.state.json,err:e.state.err,editor:!1}))}}),r.a.createElement(De.b,{path:"/editor",render:function(t){return r.a.createElement(It,Object.assign({},t,{logo:Bt.a,height:e.state.height,width:e.state.width,processYAML:e.processYAML,processURL:e.processS3URL,yaml:e.state.yaml,json:e.state.json,err:e.state.err,editor:!0}))}}),r.a.createElement(De.b,{path:"/dashboard",render:function(t){return r.a.createElement(Pt,Object.assign({},t,{logo:Bt.a,height:e.state.height,width:e.state.width,processYAML:e.processYAML,processURL:e.processS3URL,yaml:e.state.yaml,json:e.state.json,err:e.state.err,editor:!0}))}}))))}}]),t}(r.a.Component),Ft=n(77),Ht={loginError:null,user:{},userlang:"_en"},Jt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ht,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_SUCCESS":case"LOGIN_SUCCESS":return Object(i.a)({},e,{loginError:"",user:t.data,userlang:"_en"});case"LOGIN_FAILED":return Object(i.a)({},e,{loginError:"Invalid Email Address & Password combination. "});default:return e}},$t={},Qt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$t,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGOUT_SUCCESS":return Object(i.a)({},e,{logoutError:"",user:{}});case"LOGOUT_FAILED":return console.log("Logout failed"),Object(i.a)({},e,{logoutError:"Logout failed. Please try again. "});default:return e}},Vt=Object(Ft.c)({signIn:Jt,signOut:Qt}),Xt=function(e,t){return"LOGOUT_SUCCESS"===t.type&&(e=void 0),Vt(e,t)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Zt=n(232),en=(n(684),n(233)),tn={aws_project_region:"us-east-1",aws_cognito_identity_pool_id:"us-east-1:1006d6a6-988e-4147-9b6e-f91c30b1e8dc",aws_cognito_region:"us-east-1",aws_user_pools_id:"us-east-1_X9iVkLiJO",aws_user_pools_web_client_id:"vmkv14tivuv757u86hhde21de",oauth:{},aws_content_delivery_bucket:"surveykshan.com-dev",aws_content_delivery_bucket_region:"us-east-1",aws_content_delivery_url:"https://dny8vau49u78p.cloudfront.net",aws_user_files_s3_bucket:"surveykshanstorage114915-dev",aws_user_files_s3_bucket_region:"us-east-1",aws_cloud_logic_custom:[{name:"api",endpoint:"https://as25k1hts9.execute-api.us-east-1.amazonaws.com/dev",region:"us-east-1"}]};Ne.e.configure(tn);var nn=Object(Ft.d)(Xt,Object(Ft.a)(Zt.a));s.a.render(r.a.createElement(Ie.a,{store:nn},r.a.createElement(Kt,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})),Object(en.a)(window)},79:function(e){e.exports=JSON.parse('{"number":"^\\\\d+$","phonenumber":"^\\\\d{10}$","age":"^\\\\d{3}$"}')},93:function(e,t,n){e.exports=n.p+"static/media/logo.ed79d5c5.png"}},[[252,1,2]]]);
//# sourceMappingURL=main.30c88eb0.chunk.js.map